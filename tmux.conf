# Без этой команды перезагрузка конфига не отключает старые сочетания клавиш
unbind-key -a -T root

# Границы панелей в виде двойных линий
set -g pane-border-lines double

# Нумерация окон и панелей начинается с 1 (вместо 0)
set  -g base-index      1
setw -g pane-base-index 1

# Использование vi-подобных клавиш в режиме копирования
setw -g mode-keys   vi
# Включение событий фокуса (нужно для некоторых плагинов)
set  -g focus-events on

# Включение мыши
set  -g mouse             on
# Время ожидания после Escape (0 для мгновенного отклика)
set  -s escape-time       0
# Лимит истории прокрутки (2000 строк)
set  -g history-limit     2000

# Настройки терминала для правильной работы цветов
set  -g default-terminal "tmux-256color"
set -ag terminal-overrides ",xterm-256color:RGB,*256col*:RGB,alacritty:RGB,kitty:RGB"

# Перезагрузка конфига - Ctrl+r
bind -n C-r source-file ~/.config/tmux/tmux.conf \; display "Reloaded!"
# Выбор сессии - Ctrl+s
bind -n C-s choose-tree -s

# For scroll
bind -n C-p copy-mode
bind -T copy-mode-vi q send -X cancel

# Переключение между окнами 1-9 - Ctrl+1..9
bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5
bind -n M-6 select-window -t 6
bind -n M-7 select-window -t 7
bind -n M-8 select-window -t 8
bind -n M-9 select-window -t 9

# Навигация между панелями - Ctrl+стрелки
bind -n C-Left select-pane -L
bind -n C-Right select-pane -R
bind -n C-Up select-pane -U
bind -n C-Down select-pane -D

# Изменение размеров панелей - Ctrl+Shift+стрелки
bind -n C-S-Left resize-pane -L 5
bind -n C-S-Right resize-pane -R 5
bind -n C-S-Up resize-pane -U 3
bind -n C-S-Down resize-pane -D 3

# Создание панелей - Ctrl+h (горизонтальная), Ctrl+v (вертикальная)
bind -n C-h split-window -v
bind -n C-v split-window -h

# Управление окнами и панелями# Менеджер плагинов tmux
set -g @plugin 'tmux-plugins/tpm'

# Тема Gruvbox
set -g @plugin 'egel/tmux-gruvbox'

# Сохранение и восстановление сессий
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'

# Автовосстановление сессии при старте tmux
set -g @continuum-restore 'on'
# Автосохранение каждые 15 минут
set -g @continuum-save-interval '15'

# Загрузка менеджера плагинов
run '~/.config/tmux/plugins/tpm/tpm'
bind -n M-Enter new-window    # Новое окно
bind -n C-x kill-pane         # Закрыть текущую панель
bind -n C-q kill-window       # Закрыть текущее окно
bind -n C-d detach            # Отсоединиться от сессии
bind -n C-Q confirm-before -p "Kill entire session? (y/n)" kill-session  # Убить всю сессию

# Режим копирования (vi-style)
bind -T copy-mode-vi v send -X begin-selection
# Копирование в системный буфер обмена
bind -T copy-mode-vi y send -X copy-pipe-and-cancel "wl-copy || xclip -in -selection clipboard"
# Поиск вниз - Ctrl+/
bind -n C-/ copy-mode \; command-prompt -p "(search down)" "send -X search-forward '%%%'"
# Поиск вверх - Ctrl+?
bind -n C-? copy-mode \; command-prompt -p "(search up)"   "send -X search-backward '%%%'"


